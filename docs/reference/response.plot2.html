<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function for for plotting predicted responses from species
distribution models in 2 or 3 dimensions — response.plot2 • biomod2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function for for plotting predicted responses from species
distribution models in 2 or 3 dimensions — response.plot2"><meta property="og:description" content="Adaptation of the Evaluation Strip method proposed by
Elith et al.(2005). This function enables to plot the response curves
of a model independently of the algorithm used for building the model.
It therefore permits a direct comparison of predicted responses from
the different statistical approaches on the same data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biomod2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/biomodhub/biomod2.git" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function for for plotting predicted responses from species
distribution models in 2 or 3 dimensions</h1>
    <small class="dont-index">Source: <a href="https://github.com/biomodhub/biomod2/blob/HEAD/R/response.plot.R" class="external-link"><code>R/response.plot.R</code></a></small>
    <div class="hidden name"><code>response.plot2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adaptation of the Evaluation Strip method proposed by
Elith et al.(2005). This function enables to plot the response curves
of a model independently of the algorithm used for building the model.
It therefore permits a direct comparison of predicted responses from
the different statistical approaches on the same data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">response.plot2</span><span class="op">(</span>
  <span class="va">models</span>,
  <span class="va">Data</span>,
  show.variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span><span class="op">)</span>,
  do.bivariate <span class="op">=</span> <span class="cn">FALSE</span>,
  fixed.var.metric <span class="op">=</span> <span class="st">"mean"</span>,
  save.file <span class="op">=</span> <span class="st">"no"</span>,
  name <span class="op">=</span> <span class="st">"response_curve"</span>,
  ImageSize <span class="op">=</span> <span class="fl">480</span>,
  plot <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>models</dt>
<dd><p>a character vector specifying the models for which the
response curves have to be plotted. Compatible with GAM, GBM, GLM, 
ANN, CTA, RF, FDA, MARS and MAXENT.</p></dd>
<dt>Data</dt>
<dd><p>a dataframe containing the variables for which the
response curves have to be plotted. They must have the same names as
the ones used to calibrate the model. RasterStack are also supported.</p></dd>
<dt>show.variables</dt>
<dd><p>the names or the column numbers of 'Data' for
selecting the variables to be plotted. By default all columns are
taken</p></dd>
<dt>do.bivariate</dt>
<dd><p>'logical', if FALSE (default), the predicted
response curves are plotted for every singe variable independently 
(2 dimension). If TRUE, the predicted response curves are represented
in 3 dimentions for all pairs of variables</p></dd>
<dt>fixed.var.metric</dt>
<dd><p>either 'mean' (default), 'median', 'min' or
'max' specifying the statistic used to fix as constant the remaining
variables when the predicted response is estimated for one of the
variables</p></dd>
<dt>save.file</dt>
<dd><p>can be set to "pdf", "jpeg" or "tiff" to save the
plot. Pdf options can be changed by setting the default values of 
pdf.options().</p></dd>
<dt>name</dt>
<dd><p>the name of the file produced if save.file is different to
"no" (extensions are already included)</p></dd>
<dt>ImageSize</dt>
<dd><p>the size of the image in pixels if save.file is
different to "no". Affects "jpeg" and "tiff" outputs only. Default if
480 pixels which is the R default.</p></dd>
<dt>plot</dt>
<dd><p>if TRUE (the default) then a plot is produced</p></dd>
<dt>...</dt>
<dd><p>further arguments :
- <code>data_species</code> : vector containing data species occurrences.
Have to match with <code>Data</code>. If given, the statistic used to fix
variables value will be calculated only over presences points.
(Considered only if <code>Data</code> is under table format)
- <code>col</code> : vector of colors to be used (only for univariate 
case)
- <code>lty</code> : vector of lines types to be used
- <code>main</code> : character, the title of the graph (default one based
on first model class is automatically produced if not referred)
- <code>display_title</code> : logical, display or not graph title
- <code>legend</code> : logical, add legend to plot (only for univariate
case)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a 4 dimentions array is returned. It contains the necessary
outputs to produce the plots. This is useful to make your own custom
response plot graphics.
Array returned structure : 
- First dimension: the dimension of the predictions
- Second dimension: 2 or 3 columns: The first one (resp. the first 
two) is (are) the explanatory variable(s) to plot, the last one, the
probability of occurrence
- Third dimension: The set of environmental variables for which the
response.plot was asked to run.
- Fourth dimension:the selected models</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For building the predicted response curves, n-1 variables are set
constant to a fixed value (mean, median, min or max i.e 
<code>fixed.var.metric</code> arg) and only the remaining one (resp. 2 for
3D response plot) is varying across its whole range (given by
<code>Data</code>). n the case of categorical variable, the most represented
class is taken. The variations observed and the curve thus obtained
shows the sensibility of the model to that specific variable. This
method does not account for interactions between variables.
In the evaluation strip initially proposed by Elith et al. 2005 the
remaining variables are set to the mean.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Elith, J., Ferrier, S., Huettmann, FALSE. &amp; Leathwick, J. R. 2005 The
evaluation strip: A new and robust method for plotting predicted
responses from species distribution models. Ecological Modelling 186,
280-289.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wilfried Thuiller, Damien Georges</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
<span class="co">##' species occurrences</span>
<span class="va">DataSpecies</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/species/mammals_table.csv"</span>, package<span class="op">=</span><span class="st">"biomod2"</span><span class="op">)</span>, 
    row.names <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DataSpecies</span><span class="op">)</span>
<span class="co">##' the name of studied species</span>
<span class="va">myRespName</span> <span class="op">&lt;-</span> <span class="st">'VulpesVulpes'</span>
    
<span class="co">##' the presence/absences data for our species </span>
<span class="va">myResp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">DataSpecies</span><span class="op">[</span>, <span class="va">myRespName</span><span class="op">]</span><span class="op">)</span>
    
<span class="co">##' the XY coordinates of species data</span>
<span class="va">myRespXY</span> <span class="op">&lt;-</span> <span class="va">DataSpecies</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X_WGS84"</span>, <span class="st">"Y_WGS84"</span><span class="op">)</span><span class="op">]</span>

<span class="va">myExpl</span> <span class="op">&lt;-</span> 
  <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/bioclim/current/bio3.grd"</span>, package <span class="op">=</span> <span class="st">"biomod2"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/bioclim/current/bio4.grd"</span>, package <span class="op">=</span> <span class="st">"biomod2"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/bioclim/current/bio7.grd"</span>, package <span class="op">=</span> <span class="st">"biomod2"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/bioclim/current/bio11.grd"</span>, package <span class="op">=</span> <span class="st">"biomod2"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/bioclim/current/bio12.grd"</span>, package <span class="op">=</span> <span class="st">"biomod2"</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co">##' 1. Formatting Data</span>
<span class="va">myBiomodData</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="BIOMOD_FormatingData.html">BIOMOD_FormatingData</a></span><span class="op">(</span>
    resp.var <span class="op">=</span> <span class="va">myResp</span>,
    expl.var <span class="op">=</span> <span class="va">myExpl</span>,
    resp.xy <span class="op">=</span> <span class="va">myRespXY</span>,
    resp.name <span class="op">=</span> <span class="va">myRespName</span>
  <span class="op">)</span>

<span class="co">##' 2. Defining Models Options using default options.</span>
<span class="va">myBiomodOption</span> <span class="op">&lt;-</span> <span class="fu"><a href="BIOMOD_ModelingOptions.html">BIOMOD_ModelingOptions</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">##' 3. Doing Modelisation</span>
<span class="va">myBiomodModelOut</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="BIOMOD_Modeling.html">BIOMOD_Modeling</a></span><span class="op">(</span>
    <span class="va">myBiomodData</span>,
    models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GLM'</span>,<span class="st">'RF'</span><span class="op">)</span>,
    models.options <span class="op">=</span> <span class="va">myBiomodOption</span>,
    NbRunEval <span class="op">=</span> <span class="fl">2</span>,
    DataSplit <span class="op">=</span> <span class="fl">80</span>,
    VarImport <span class="op">=</span> <span class="fl">0</span>,
    models.eval.meth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span>,<span class="st">'ROC'</span><span class="op">)</span>,
    do.full.models <span class="op">=</span> <span class="cn">FALSE</span>,
    modeling.id <span class="op">=</span> <span class="st">"test"</span>
  <span class="op">)</span>
<span class="co">##' 4. Plot response curves</span>
<span class="co">##' 4.1 Load the models for which we want to extract the predicted</span>
<span class="co">##' response curves</span>
<span class="va">myGLMs</span> <span class="op">&lt;-</span> <span class="fu">BIOMOD_LoadModels</span><span class="op">(</span><span class="va">myBiomodModelOut</span>, models <span class="op">=</span> <span class="st">'GLM'</span><span class="op">)</span>
    
<span class="co">##' 4.2 plot 2D response plots</span>
<span class="va">myRespPlot2D</span> <span class="op">&lt;-</span> 
  <span class="fu">response.plot2</span><span class="op">(</span>
    models <span class="op">=</span> <span class="va">myGLMs</span>,
    Data <span class="op">=</span> <span class="fu">get_formal_data</span><span class="op">(</span><span class="va">myBiomodModelOut</span>, <span class="st">'expl.var'</span><span class="op">)</span>,
    show.variables <span class="op">=</span> <span class="fu">get_formal_data</span><span class="op">(</span><span class="va">myBiomodModelOut</span>,<span class="st">'expl.var.names'</span><span class="op">)</span>,
    do.bivariate <span class="op">=</span> <span class="cn">FALSE</span>,
    fixed.var.metric <span class="op">=</span> <span class="st">'median'</span>,
    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>,
    legend <span class="op">=</span> <span class="cn">TRUE</span>,
    data_species <span class="op">=</span> <span class="fu">get_formal_data</span><span class="op">(</span><span class="va">myBiomodModelOut</span>, <span class="st">'resp.var'</span><span class="op">)</span>
  <span class="op">)</span>
    
<span class="co">##' 4.2 plot 3D response plots</span>
<span class="co">###' here only for a lone model (i.e "VulpesVulpes_PA1_AllData_GLM")</span>
<span class="va">myRespPlot3D</span> <span class="op">&lt;-</span> 
  <span class="fu">response.plot2</span><span class="op">(</span>
  models <span class="op">=</span> <span class="va">myGLMs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
  Data <span class="op">=</span> <span class="fu">get_formal_data</span><span class="op">(</span><span class="va">myBiomodModelOut</span>, <span class="st">'expl.var'</span><span class="op">)</span>, 
  show.variables <span class="op">=</span> <span class="fu">get_formal_data</span><span class="op">(</span><span class="va">myBiomodModelOut</span>, <span class="st">'expl.var.names'</span><span class="op">)</span>,
  do.bivariate <span class="op">=</span> <span class="cn">TRUE</span>,
  fixed.var.metric <span class="op">=</span> <span class="st">'median'</span>,
  data_species <span class="op">=</span> <span class="fu">get_formal_data</span><span class="op">(</span><span class="va">myBiomodModelOut</span>, <span class="st">'resp.var'</span><span class="op">)</span>,
  display_title <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
    
<span class="co">##' all the values used to produce this plot are stored into the</span>
<span class="co">##' returned object you can redo plots by yourself and customised </span>
<span class="co">##' them</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">myRespPlot2D</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">myRespPlot2D</span><span class="op">)</span>
    
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">myRespPlot3D</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">myRespPlot3D</span><span class="op">)</span>
<span class="op">}</span>

</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Damien Georges.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

